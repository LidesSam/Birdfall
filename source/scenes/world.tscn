[gd_scene load_steps=18 format=4 uid="uid://dvvy75jb8tc0d"]

[ext_resource type="Texture2D" uid="uid://b33delcwra5dt" path="res://assets/sprites/tileset.png" id="1_0mw4y"]
[ext_resource type="Material" uid="uid://dokqq7kuxo23v" path="res://assets/shaders/metallic-blue.tres" id="1_22jhh"]
[ext_resource type="Script" uid="uid://bd5cl7hib232v" path="res://source/scenes/world.gd" id="1_mtj5w"]
[ext_resource type="PackedScene" uid="uid://cjkdl4rpglr3s" path="res://source/elements/player.tscn" id="2_mtj5w"]
[ext_resource type="Texture2D" uid="uid://c46hkht4auqja" path="res://assets/sprites/Solid-shade.png" id="3_tl0iy"]
[ext_resource type="PackedScene" uid="uid://ddskdoxd1qhi3" path="res://source/elements/cronoclock.tscn" id="5_nai4x"]
[ext_resource type="PackedScene" uid="uid://d04x6pnkk63th" path="res://source/elements/timeleft.tscn" id="6_an0i8"]
[ext_resource type="Texture2D" uid="uid://b8oln5y4locpg" path="res://assets/sprites/solid-block.png" id="8_0iyr7"]
[ext_resource type="Script" uid="uid://ct5qkh0wai5c5" path="res://addons/fsmgear/source/Fsm.gd" id="8_j1nvq"]
[ext_resource type="Script" uid="uid://80m0h04t1ao7" path="res://source/scenes/gameWorldStates/startStageState.gd" id="9_od6b4"]
[ext_resource type="Script" uid="uid://dk6fjngxkiftm" path="res://addons/fsmgear/source/FsmState.gd" id="10_mi3e2"]
[ext_resource type="Script" uid="uid://dysw2chf8hifx" path="res://source/scenes/gameWorldStates/onStageState.gd" id="10_od6b4"]
[ext_resource type="Script" uid="uid://bkh4e3qceynwt" path="res://source/scenes/gameWorldStates/lossStageState.gd" id="13_kf3fs"]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_22jhh"]
texture = ExtResource("1_0mw4y")
texture_region_size = Vector2i(32, 32)
0:0/0 = 0
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
1:0/0 = 0
1:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
2:0/0 = 0
3:0/0 = 0
0:1/0 = 0
0:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
1:1/0 = 0
1:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
2:1/0 = 0
3:1/0 = 0
0:2/0 = 0
0:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-13.3825, -13.3825, 13.3825, -12.7452, 13.0639, 12.7452, -13.0639, 12.7452)
1:2/0 = 0
2:2/0 = 0
3:2/0 = 0
0:3/0 = 0
1:3/0 = 0
2:3/0 = 0
3:3/0 = 0
0:4/0 = 0
1:4/0 = 0
0:5/0 = 0
1:5/0 = 0

[sub_resource type="TileSet" id="TileSet_nai4x"]
tile_size = Vector2i(32, 32)
physics_layer_0/collision_layer = 1
sources/0 = SubResource("TileSetAtlasSource_22jhh")

[sub_resource type="Shader" id="1"]
code = "shader_type canvas_item;
uniform vec4 light : source_color;
uniform vec4 normal : source_color;
uniform vec4 shade : source_color;
uniform vec4 outline : source_color;

uniform vec4 swapLight : source_color;
uniform vec4 swapNormal : source_color;
uniform vec4 swapShade : source_color;
uniform vec4 swapOutline : source_color;

const float precision = 0.1;


void fragment(){
	vec4 current_color = texture(TEXTURE,UV);
		if(distance(current_color,light)<=precision){
			COLOR = swapLight;
		}
		else if(distance(current_color,normal)<=precision){
			COLOR = swapNormal;
		}
		
		else if(distance(current_color,shade)<=precision){
			COLOR = swapShade;
		}
		else if(distance(current_color,outline)<=precision){
			COLOR = swapOutline;
		}
		else{
			COLOR = current_color;
		}
		
		
}

"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_mtj5w"]
resource_local_to_scene = true
shader = SubResource("1")
shader_parameter/light = Color(0.87451, 0.87451, 0.87451, 1)
shader_parameter/normal = Color(0.623529, 0.623529, 0.623529, 1)
shader_parameter/shade = Color(0.376471, 0.376471, 0.376471, 1)
shader_parameter/outline = Color(0.12549, 0.12549, 0.12549, 1)
shader_parameter/swapLight = Color(0, 0, 0, 1)
shader_parameter/swapNormal = Color(0.0392157, 0.580392, 0.807843, 1)
shader_parameter/swapShade = Color(0, 0.0980392, 0.466667, 1)
shader_parameter/swapOutline = Color(0.258824, 0.839216, 0.52549, 1)

[node name="World" type="Node2D"]
material = ExtResource("1_22jhh")
use_parent_material = true
script = ExtResource("1_mtj5w")

[node name="TextureRect" type="TextureRect" parent="."]
use_parent_material = true
offset_left = -496.0
offset_top = -480.0
offset_right = 1192.0
offset_bottom = 664.0
texture = ExtResource("3_tl0iy")

[node name="TileMap" type="TileMapLayer" parent="."]
use_parent_material = true
tile_map_data = PackedByteArray("AAD8/wMAAAAAAAAAAAD9/wMAAAAAAAAAAAD+/wMAAAAAAAAAAAD//wMAAAAAAAAAAAAAAAMAAAAAAAAAAAABAAMAAAAAAAAAAAACAAMAAAAAAAAAAAADAAMAAAAAAAAAAAD7/wMAAAAAAAAAAAABAAIAAAAAAAEAAAABAAEAAAAAAAEAAAABAAAAAAABAAEAAAD9//7/AAABAAEAAAD9////AAAAAAEAAAD9/wAAAAAAAAEAAAD9/wEAAAAAAAEAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAEAAAAAAAAAAEAAAAEAP//AAAAAAEAAAAEAP7/AAAAAAEAAAAEAP3/AAAAAAEAAAABAP3/AAAAAAEAAAABAPz/AAAAAAEAAAAEAPz/AAABAAEAAAABAPv/AAABAAEAAAD7/wIAAAAAAAAAAAD7/wEAAAAAAAAAAAD7/wAAAAAAAAAAAAD7////AAAAAAAAAAD7//7/AAAAAAAAAAD7//3/AAAAAAAAAAD7//z/AAAAAAAAAAD7//v/AAAAAAAAAAD7//r/AAAAAAAAAAD7//n/AAAAAAAAAAD7//j/AAAAAAAAAAD7//f/AAAAAAAAAAD8//f/AAAAAAAAAAD9//f/AAAAAAAAAAD+//f/AAAAAAAAAAD///f/AAAAAAAAAAAAAPf/AAAAAAAAAAABAPf/AAAAAAAAAAACAPf/AAAAAAAAAAADAPf/AAAAAAAAAAAEAPf/AAAAAAAAAAAFAPf/AAAAAAAAAAAGAPf/AAAAAAAAAAAHAPf/AAAAAAAAAAAIAPf/AAAAAAAAAAAJAPf/AAAAAAAAAAAKAPf/AAAAAAAAAAALAPf/AAAAAAAAAAAMAPf/AAAAAAAAAAANAPf/AAAAAAAAAAAEAAEAAAAAAAAAAAAEAAIAAAAAAAAAAAAEAAMAAAAAAAAAAAAEAAQAAAAAAAAAAAAEAAUAAAAAAAEAAAAEAAYAAAAAAAEAAAAEAAcAAAAAAAEAAAAEAAgAAAAAAAEAAAAEAAkAAAAAAAAAAAAFAAkAAAAAAAAAAAAGAAkAAAAAAAAAAAAHAAkAAAAAAAAAAAAIAAkAAAAAAAAAAAAJAAkAAAAAAAAAAAAKAAkAAAAAAAAAAAALAAkAAAAAAAAAAAAMAAkAAAAAAAAAAAANAAkAAAAAAAAAAAAOAAkAAAAAAAAAAAAPAAkAAAAAAAAAAAAQAAkAAAAAAAAAAAARAAkAAAAAAAAAAAASAAkAAAAAAAAAAAATAAkAAAAAAAAAAAAUAAkAAAAAAAAAAAAVAAkAAAAAAAAAAAAVAAgAAAAAAAAAAAAVAAcAAAAAAAAAAAAVAAYAAAAAAAAAAAAUAAYAAAAAAAAAAAATAAYAAAAAAAAAAAASAAYAAAAAAAAAAAARAAYAAAAAAAAAAAARAAcAAAAAAAAAAAARAAgAAAAAAAAAAAAOAPf/AAAAAAAAAAAPAPf/AAAAAAAAAAAQAPf/AAAAAAAAAAARAPf/AAAAAAAAAAASAPf/AAAAAAAAAAATAPf/AAAAAAAAAAAUAPf/AAAAAAAAAAAVAPf/AAAAAAAAAAAVAPj/AAAAAAAAAAAVAPn/AAAAAAAAAAAVAPr/AAAAAAAAAAAVAPv/AAAAAAAAAAAVAPz/AAAAAAAAAAAVAP3/AAAAAAAAAAAVAP7/AAAAAAAAAAAVAP//AAAAAAAAAAAVAAIAAAAAAAAAAAAVAAMAAAAAAAAAAAAVAAQAAAAAAAAAAAAVAAUAAAAAAAAAAAAVAAEAAAAAAAAAAAAVAAAAAAAAAAAAAAASAAgAAAAAAAAAAAATAAgAAAAAAAAAAAATAAcAAAAAAAAAAAASAAcAAAAAAAAAAAAUAAcAAAAAAAAAAAAUAAgAAAAAAAAAAAAFAAgAAAAAAAIAAAAGAAgAAAAAAAIAAAAHAAgAAAAAAAIAAAAIAAgAAAAAAAIAAAAJAAgAAAAAAAIAAAAKAAgAAAAAAAIAAAALAAgAAAAAAAIAAAAMAAgAAAAAAAIAAAANAAgAAAAAAAIAAAAOAAgAAAAAAAIAAAAPAAgAAAAAAAIAAAAQAAgAAAAAAAIAAAAQAAcAAAAAAAIAAAAPAAcAAAAAAAIAAAAOAAcAAAAAAAIAAAANAAcAAAAAAAIAAAAMAAcAAAAAAAIAAAALAAcAAAAAAAIAAAAKAAcAAAAAAAIAAAAJAAcAAAAAAAIAAAAIAAcAAAAAAAIAAAAHAAcAAAAAAAIAAAAGAAcAAAAAAAIAAAANAPv/AAAAAAEAAAANAPz/AAAAAAEAAAANAP3/AAAAAAEAAAANAP7/AAAAAAEAAAAKAAEAAAAAAAEAAAAKAP//AAAAAAIAAAAKAAAAAAAAAAEAAAAKAAIAAAAAAAEAAAAKAAMAAAAAAAEAAAAKAAQAAAAAAAEAAAAFAAcAAAAAAAIAAAANAPr/AAAAAAIAAAANAP//AAAAAAIAAAAUAPz/AAAAAAIAAAATAPz/AAAAAAIAAAASAPz/AAAAAAIAAAARAPz/AAAAAAIAAAARAP3/AAAAAAIAAAARAP7/AAAAAAIAAAASAP7/AAAAAAIAAAATAP7/AAAAAAIAAAAUAP7/AAAAAAIAAAAUAP3/AAAAAAIAAAATAP3/AAAAAAIAAAASAP3/AAAAAAIAAAAQAPz/AAAAAAIAAAAPAPz/AAAAAAIAAAAOAPz/AAAAAAIAAAAOAP3/AAAAAAIAAAAPAP3/AAAAAAIAAAAQAP3/AAAAAAIAAAAPAPv/AAAAAAIAAAAPAPr/AAAAAAIAAAAPAPn/AAAAAAIAAAAOAPn/AAAAAAIAAAAOAPj/AAAAAAIAAAAOAPr/AAAAAAIAAAAOAPv/AAAAAAIAAAAPAPj/AAAAAAIAAAAQAPj/AAAAAAIAAAARAPj/AAAAAAIAAAARAPn/AAAAAAIAAAARAPr/AAAAAAIAAAAQAPr/AAAAAAIAAAASAPv/AAAAAAIAAAASAPr/AAAAAAIAAAASAPn/AAAAAAIAAAASAPj/AAAAAAIAAAATAPj/AAAAAAIAAAATAPn/AAAAAAIAAAATAPr/AAAAAAIAAAATAPv/AAAAAAIAAAAUAPv/AAAAAAIAAAAUAPr/AAAAAAIAAAAUAPn/AAAAAAIAAAAUAPj/AAAAAAIAAAARAPv/AAAAAAIAAAAQAPv/AAAAAAIAAAAQAPn/AAAAAAIAAAADAAEAAAAAAAAAAAACAAEAAAAAAAAAAAACAAIAAAAAAAAAAAADAAIAAAAAAAAAAAA=")
tile_set = SubResource("TileSet_nai4x")

[node name="Node2D" type="Node2D" parent="."]
use_parent_material = true

[node name="Cronoclock" parent="Node2D" instance=ExtResource("5_nai4x")]
position = Vector2(152, -144)

[node name="Cronoclock2" parent="Node2D" instance=ExtResource("5_nai4x")]
position = Vector2(16, 80)

[node name="player" parent="." instance=ExtResource("2_mtj5w")]
material = SubResource("ShaderMaterial_mtj5w")
use_parent_material = true
position = Vector2(-24, 64)

[node name="Camera2D" type="Camera2D" parent="player"]

[node name="hud" type="CanvasLayer" parent="."]

[node name="root" type="Control" parent="hud"]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="Label" type="Label" parent="hud/root"]
use_parent_material = true
layout_mode = 0
offset_right = 312.0
offset_bottom = 49.0
text = "Score
"
horizontal_alignment = 1
vertical_alignment = 1
metadata/_edit_use_anchors_ = true

[node name="time" parent="hud/root" instance=ExtResource("6_an0i8")]
use_parent_material = true
offset_left = 312.0
offset_top = 0.0
offset_right = 568.0
offset_bottom = 32.0
metadata/_edit_use_anchors_ = true

[node name="countLBL" type="Label" parent="hud/root"]
use_parent_material = true
layout_mode = 0
offset_right = 576.0
offset_bottom = 328.0
theme_override_colors/font_color = Color(0.376471, 0.376471, 0.376471, 1)
text = "3"
metadata/_edit_use_anchors_ = true

[node name="countdownTimer" type="Timer" parent="hud/root"]
wait_time = 4.0
one_shot = true

[node name="endpopup" type="TextureRect" parent="hud/root"]
visible = false
use_parent_material = true
layout_mode = 0
offset_right = 480.0
offset_bottom = 320.0
texture = ExtResource("8_0iyr7")

[node name="Label" type="Label" parent="hud/root/endpopup"]
use_parent_material = true
layout_mode = 0
offset_left = 24.0
offset_top = 65.0
offset_right = 448.0
offset_bottom = 128.0
text = "YOUR SCORE: 000000"
horizontal_alignment = 1
vertical_alignment = 1

[node name="backButton" type="Button" parent="hud/root/endpopup"]
use_parent_material = true
layout_mode = 0
offset_left = 64.0
offset_top = 192.0
offset_right = 416.0
offset_bottom = 256.0
text = "Back"

[node name="fsm" type="Node" parent="."]
script = ExtResource("8_j1nvq")
metadata/_custom_type_script = "uid://ct5qkh0wai5c5"

[node name="startStage" type="Node" parent="fsm"]
script = ExtResource("9_od6b4")
metadata/_custom_type_script = "uid://dk6fjngxkiftm"

[node name="onStage" type="Node" parent="fsm"]
script = ExtResource("10_od6b4")
metadata/_custom_type_script = "uid://dk6fjngxkiftm"

[node name="completeStage" type="Node" parent="fsm"]
script = ExtResource("10_mi3e2")
metadata/_custom_type_script = "uid://dk6fjngxkiftm"

[node name="lossStage" type="Node" parent="fsm"]
script = ExtResource("13_kf3fs")
metadata/_custom_type_script = "uid://dk6fjngxkiftm"

[connection signal="pressed" from="hud/root/endpopup/backButton" to="." method="_on_back_button_pressed"]
